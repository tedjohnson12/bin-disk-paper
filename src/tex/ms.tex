% Define document class
\documentclass[twocolumn]{aastex631}
\usepackage{showyourwork}
\usepackage{amsmath}
\usepackage{bm}

\newcommand\ghurl[0]{\url{https://github.com/tedjohnson12/bin-disk-paper}}
\newcommand\codeurl[0]{\url{https://github.com/tedjohnson12/misaligned_cb_disk}}
\newcommand\getref[0]{(\textcolor{red}{ref?})}
\newcommand\question[1]{[\textcolor{red}{#1}]}

\newcommand{\TJ}[1]{\textcolor{orange}{#1}}
\newcommand{\RGM}[1]{\textcolor{cyan}{#1}}

\DeclareMathOperator{\arctantwo}{arctan2}
\DeclareMathOperator{\arccsc}{arccsc}

% Begin!
\begin{document}

% Title
\title{Probabilities of polar aligned disks in binary star systems}

% Author list
\author{Ted Johnson}
%\affiliation{Department of Physics and Astronomy, University of Nevada, Las Vegas, 4505 South Maryland Parkway, Las Vegas, NV 89154, USA}
\author{Rebecca G. Martin}
%\affiliation{Department of Physics and Astronomy, University of Nevada, Las Vegas, 4505 South Maryland Parkway, Las Vegas, NV 89154, USA}
\author{Stephen Lepp}
\affiliation{Nevada Center for Astrophysics, University of Nevada, Las Vegas, 4505 South Maryland Parkway, Las Vegas, NV 89154, USA}
\affiliation{Department of Physics and Astronomy, University of Nevada, Las Vegas, 4505 South Maryland Parkway, Las Vegas, NV 89154, USA}
\author{Stephen H. Lubow}
\affiliation{Space Telescope Science Institute, 3700 San Martin Drive, Baltimore, MD 21218, USA}

% Abstract with filler text
\begin{abstract}
    Circumbinary gas disks that are misaligned to the binary orbital plane evolve toward either a coplanar or a polar-aligned configuration with respect to the binary host.
    The preferred alignment can be found analytically
    in the limit of a massless disk, however disk-binary interactions make the massive disk case much more challenging.
    We employ the N-body code {\sc rebound} to investigate the dynamics of  3-body systems and use Monte Carlo methods
    to quantify the probabilities of each alignment for an initially randomly orientated disk around a given system.
\end{abstract}

\section{Introduction}
\label{sec:intro}



Observed circumbinary planets -- those orbiting around two stars -- have been mostly found to orbit in the same plane as
their hosts \citep{doyle2011,orosz2012,welsh2012}. However, this is likely a result of selection effects \RGM{(citations by David Martin..)}.  Misaligned disks around eccentric binaries evolve \RGM{either to coplanar (citations)} to a polar state  \citep{aly2015,martin2017}. A polar-aligned debris disk has been found in the 99 Her system
\citep{kennedy2012} and polar-aligned gas disks have been found in the HD 98800 \citep{kennedy2019} and V773 Tau systems \citep{kenworthy2022}.
AC Her, a post-AGB system with a polar-inclined
disk, may host the first circumbinary planet found in a polar orbit \citep{hillen2015,anugu2023,martin2023}.


The alignment of circumbinary planets, and the alignment of the disks from which they form, are determined by their interaction history with their
host stars. \RGM{For a massless} circumbinary disk, the type of nodal precession can be split into two categories:

\begin{enumerate}
    \item {\bf Precession about the angular momentum vector of the binary.} In the case where the planet/disk
        is slightly misalignend, its own angular momentum vector precesses about that of the binary \citep[e.g.,][]{bate2000,lubow2000}.
        This is characterized by near constant
        inclination and oscillation of the longitude of the ascending node. Included in this case is the subclassification
        of retrograde orbits (those whose angular momentum vectors are misaligend by $\sim 180 \deg$) and the two
        trivial cases of perfectly aligned/misaligend orbits which do not precess. \label{enum:precession}
    \item {\bf Libration about the eccentricity vector of the binary.} In the case where misalignment is high (i.e. near
    perpendicular) the angular momentum vector of the planet/disk precesses about the eccentricity vector of the binary 
    \citep[e.g.,][]{verrier2009,farago2010,doolin2011}. This is called a librating orbit. In this case the mutual inclination of the disk oscillates about the polar configuration.
    \label{enum:libration}
\end{enumerate}

\RGM{However, for a massive disk, there are additional types of nodal precesion.... (describe) \citep{abod2022}.}

Planets form with the orbital characteristics given by their progenitor disks \citep[e.g.,][]{childs2021}, so it is sufficient in this work to
discuss disk dynamics only.
Differential precession between adjacent annular regions in a disk cause dissipation, ultimately dampening precession or libration
so that the disk reaches a steady state on its viscous timescale \citep[see also \citet{nixon2011,foucart2013,foucart2014}]{bate2000}.
Therefore, it is appropriate to map a disk's
initial interactions with a binary (prograde precession, libration, retrograde precession) to the disk's final configuration
(prograde coplanar, circumpolar, retrograde coplanar, respectively).

In the case of a massless disk, the type of interaction can be determined analytically from just the binary eccentricity and the
direction of the disk's specific angular momentum vector
\citep[parameterized by the disk inclination and its longitude of the ascending node][]{zanazzi2018}.
Given priors on these quantities we can predict the observed frequencies of circumbinary disks (and planets) in the polar configuration.
\citet{ceppi2024} do just this -- finding the fractions of binaries with polar disks and the mean eccentricities of those binaries
as a function of two free parameters.

In this work we will study the more general case of a massive disk. The resulting polar frequency function only contains one
additional parameter, but the orbital parameters of the binary can now change due to interactions with the disk. The additional
complications of this case require the application of numerical simulations; we use the N-body code {\sc rebound} \citep{rebound} to simulate the
dynamics of a three-body system, with a massive point particle used as a stand-in for the disk. \citet{abod2022} found that this 3-body
setup is a valid description of a disk with angular momentum equal to that of the third body in the limit that the disk mass does not change
(i.e. no accretion). This setup also cannot account for warping effects and disk breakage as we must treat the disk as a solid body. 
We describe this setup in detail in Section \ref{sec:methods}

\question{describe the regime we are working in}


\section{Analytic Treatment}
\label{sec:analytic}
For a massive ring misaligend to its binary host stars, \citet{martin2019} give two conditions for libration. Each condition valid for a different regime of constant of motion $\chi$ (see their Equations 31, 32, 38), defined as
\begin{equation}
    \chi = e_{\rm b}^2 - 2\,(1 - e_{\rm b}^2)\,j\,(2j + \cos{i})
\end{equation}
for binary eccentricity $e_{\rm b}$, normalized ring angular momentum $j = J_{\rm r}/J_{\rm b}$, and mutual inclination $i$. These conditions can be rearranged to find the minimum value of $\Omega$ that will allow for a librating orbit.
\begin{equation}
    \label{eq:omega_min}
    \sin^2{\Omega_{\rm min}} = 
    \left \{
    \begin{array}{lr}
         \frac{(1-e_{\rm b}^2) (2j + \cos^2{i})}{5 e_{\rm b}^2 \sin^2{i}} & \text{if} ~\chi \ge 0 \\
    \frac{2}{5 \sin^2{i}} + \frac{\cos{i}}{5j \sin^2{i}} - \frac{e_{\rm b}^2}{20 j^2 (1-e_{\rm b}^2) \sin^2{i}} & \text{if} ~\chi < 0
    \end{array}
    \right .
\end{equation}

The range of $\sin^2{\Omega_{\rm min}}$ being $[0,1]$ there exists some $i_{\rm crit}$ below which all orbits circulate. In the $\chi \ge 0$ case this satisfies the equation
\begin{equation}
    \label{eq:icrit1}
    \frac{5 e_{\rm b}^2}{1-e_{\rm b}^2} \sin^2{i_{\rm crit}} - (\cos{i_{\rm crit}} + 2j)^2 = 0
\end{equation}

And in the $\chi < 0$ case $i_{\rm crit}$ satisfies
\begin{equation}
    \label{eq:icrit2}
    \sin^2{i_{\rm crit}} - \frac{\cos{i_{\rm crit}}}{5j} + \frac{e_{\rm b}^2}{20 j^2 (1-e_{\rm b}^2)} + \frac{2}{5} = 0
\end{equation}
Such that if the LHS of Equation \ref{eq:icrit1} or \ref{eq:icrit2} (depending on the value of $\chi$) evaluate to $<0$ then only circulating orbits are allowed.

To get the probability of a polar orbit given randomly distributed $\Omega$ we can use a modified version of Equation 8 from \citet{ceppi2024}.
\begin{equation}
    P(j,e_{\rm b}, i) = 
    \left \{
    \begin{array}{lr}
         1 - \frac{2}{\pi} \Omega_{\rm min} & \text{if} ~i > i_{\rm crit} \\
        0 & \text{if} ~i \le i_{\rm crit}
    \end{array}
    \right .
\end{equation}
From which the fraction of total polar orbits can be calculated
\begin{equation}
    \label{eq:fp_int}
    f_{\rm polar} = \iiint P(j,e_{\rm b}, i)\, dj\,de_{\rm b}\,di
\end{equation}
This integral is straightforward to compute numerically, and allows for any desired distribution in $j$, $e_{\rm b}$, or $i$, so long as they are normalized. For example, an isotropic distribution of disks would require we replace $di$ with $\frac{1}{2}\sin{u}\,du$ for $u \in [0,\pi]$.

\subsection{High-$j$ limit}
\label{subsec:high_j}

When $j$ is very large, the $\chi < 0$ branch of Equation \ref{eq:omega_min} becomes
\begin{equation}
    \sin^2{\Omega_{\rm min}} = \frac{2}{5}\csc^2{i}
\end{equation}

The value of $i_{\rm crit}$ is then
\begin{equation}
    i_{\rm crit} = \arccsc{\sqrt{5/2}} = 39.2^\circ
\end{equation}
which is the inclination of the last circular orbit for Kozai-Lidov oscillations in the limit that the perturbed object is very far from the perturbers \citep{kozai1962,lidov1962}. It also has no dependence on the disk angular momentum or on the binary eccentricity. For an isotropic angular momentum distribution, find that the polar fraction in this limit is
\begin{equation}
    f_{{\rm polar}, j \gg 1} = \int_0^\pi\,\left (1-\frac{2}{\pi}\arcsin{\left (\sqrt{\frac{2}{5}} \csc{i} \right )}\right ) \sin{i}\,di = \variable{output/high_j_integral.txt}
\end{equation}
This is the value that the higher $j$ curves in Figure \ref{fig:ebin} tend to for low $e_{\rm b}$.

To interpret the Kozai-Lidov oscillations in this limit we can picture a system from the point of view of a far-away stationary observer. When $j \approx 0$, the orbital parameters of the interior binary are not effected by the disk, and the disk undergoes precession or libration due to the effects of the binary. When $j$ is high, however, it is the disk that appears static. An observer would see oscillations in the orbital parameters of the central binary, and its angular momentum and eccentricity vectors would change in response to the disk. This can be thought of in terms of the classical Kozai-Lidov problem, where instead of a planet and its satellite, the interior objects are the binary, and the exterior perturbing object is the circumbinary disk.

\TJ{Does this explain why we see prograde precession when $i=\pi$ for high $j$. Will prograde precession of an anti-aligned disk lead to alignment?}


\section{Runge-Kutta-Fehlburg method}
\label{sec:rk}
\citet[Equations (7-10)]{martin2019} also provide a set of coupled first-order differential equations that describe the evolution of $e_{\rm b}$ along with the direction of the disk angular momentum $(\ell_x, \ell_y, \ell_z)$, based on previous work by \citet{farago2010}. We solve these equations using the Runge-Kutta-Fehlberg (RKF) method \TJ{ref?} -- a numerical method similar to the common 4th order Runge-Kutta integrator, but that computes a 5th order solution to allow for a variable step size. This method treats the binary in the quadrupole approximation, meaning that it is not sensitive to the effects of the binary mass fraction or orbital dynamics that occur on timescales less than the binary orbital period. However, the computational cost is extremely low; we are able to run $10^4$-$10^5$ simulations per second -- about 10,000 times faster than using \sc{REBOUND} in Section \ref{sec:reb}.

We determine the dynamical state of the system by tracking the orbital quantities $x=i\,\cos{\Omega}$ and $y=i\,\sin{\Omega}$. If a disk undergoes prograde precession, then these quantities form clockwise loops about the origin as the system evolves. Under retrograde precession, these loops are counter-clockwise. However, any state that would lead to a polar orbit (i.e. libration and crescent patterns) will form closed loops that do not encompass the origin, and these tracks will never cross the line $i\,\sin{\Omega}=0$. The state can be determined by tracking the quadrant of the point $(i\,\cos{\Omega},~i\,\sin{\Omega})$: prograde orbits will traverse all quadrants in the order [I, IV, III, II], and retrograde orbits will travel in the opposite order. A polar orbit that stars in quadrant I or II, however, is restricted to those two quadrants and will alternate between them. The same goes for polar orbits in quadrants III and IV. Therefore, the dynamical state can often be determined by the list of previous quadrant crossings. For example, I$\rightarrow$IV can only be caused by prograde precession, III$\rightarrow$IV is ambiguous, and III$\rightarrow$IV$\rightarrow$III indicates a polar orbit.

We estimate the value of Equation (\ref{eq:fp_int}) using this method by computing the integral of $P(j,e_{\rm b},i)\,di$ over all $i$; this is the probability of a polar orbit given some $j$ and $e_{\rm b}$. This is done numerically using a grid of simulations, as shown if Figure \ref{fig:grid_example}. These simulations all vary in their initial conditions, with the longitude of the ascending node $\Omega \in [0,2\pi)$ and mutual inclination $i \in [0,\pi]$.

\begin{figure}
    \begin{centering}
        \includegraphics[width=0.5\textwidth]{figures/grid_example.pdf}
    \end{centering}
    \caption{
        Grid of dynamical states for $10^6$ RKF simulations of a system with $e_{\rm b}=0.5$ and $j=0.1$. This grid can be run for any combination of $(e_{\rm b},\,j)$, and integrating over the polar region computes the fraction of systems in which a disk would evolve to a polar state.
    }
    \script{grid_example.py}
    \label{fig:grid_example}
\end{figure}


\section{Methods}
\label{sec:methods}
We describe two methods to approximate the evolution of a binary-disk system, each optimized for a different balance of computational cost and physical realism.
First, we use the N-body code {\sc REBOUND} \citep{rebound} to simulate the disk using a point mass. The second method employs a Runge-Kutta-Fehlburg integrator to solve
equations (7-10) from \citet{martin2019}. These equations treat the central binary in the quadrupole approximation, but can be solved extremely efficiently.
The code used to run these simulations is publically available\footnote{\codeurl}.

\subsection{Geometric considerations}
\label{subsec:setup}

\begin{figure}
    \begin{centering}
        \includegraphics[width=0.5\textwidth]{figures/sim_example.pdf}
        \caption{Example of system simulation and state determination. This figure tracks the orbital parameters
        of a massless third body orbiting a $1 M_\odot$ binary with equal mass stars and $e_b = 0.4$.
        Initially $\Omega = \frac{\pi}{2}$.
        Solid lines indicate
        the portion of the simulation that is required to determine the state. Dashed lines complete the evolution back to the system's
        initial conditions but are not needed for our analysis. In general, we will only integrate until the state of the system can be
        determined.}
        \label{fig:sim_example}
        \script{sim_example.py}
    \end{centering}
\end{figure}

The dynamical state of the disk (i.e. prograde circulation, libration, etc.) is determined by tracking two relevant orbital elements:
mutual inclination $i$ and longitude of ascending node $\Omega$. Each simulation method gives as an output the direction of the disk angular momentum relative to
the binary $\bm{l}$. We define a coordinate system relative to the binary, with the $z$-axis to be along the
angular momentum vector, the $x$-axis to be along the eccentricity vector, and the
$y$-axis so that the coordinate system is right-handed.

The relevant coordinates are then defined

\begin{equation}
    \cos{i} = \frac{\bm{l} \cdot \hat{\bm{z}}}{\|\bm l\|}
    \label{eq:inclination}
\end{equation}

and

\begin{equation}
    \Omega = \arctantwo (\bm{l} \cdot \hat{\bm{x}}, -\bm{l} \cdot \hat{\bm{y}})
    \label{eq:omega}
\end{equation}

Given some initial $(i,\Omega)$, the system can be evolved forward in time to recover the familiar diagram shown in Figure \ref{fig:sim_example}.
\TJ{cite papers that have similar figures.}
This visualiztaion also allows the dynamical state to be resolved programically, as a librating state will repeatedly cross the $y$-axis and never
cross the $x$-axis, and a circulating state will sequentially cross each axis in an order that can determine if it is prograde or retrograde.


\subsection{Using {\sc REBOUND}}
\label{subsec:reb}

\begin{table*}
    \begin{tabular}{cccp{0.5\textwidth}}
        \hline
        name & symbol & type & description \\
        \hline
        \texttt{mass\_binary} & $M_b$ & \texttt{float} & The total mass of the binary in solar masses. \\
        \texttt{mass\_fraction} & $f_b$ & \texttt{float} & The ratio between the secondary mass and the binary mass $M_2/M_b$. \\
        \texttt{semimajor\_axis\_binary} & $a_b$ & \texttt{float} & The semimajor axis of the binary orbit. \\
        \texttt{eccentricity\_binary} & $e_b$ & \texttt{float} & The eccentricity of the binary orbit. \\
        \texttt{mass\_planet} & $m_p$ & \texttt{float} & The mass of the third body. \\
        \texttt{semimajor\_axis\_planet} & $a_p$ & \texttt{float} & The semimajor of the third body orbiting the binary center of mass. \\
        \texttt{inclination\_planet} & $i$ & \texttt{float} & The mutual inclination of the binary and the third body. \\
        \texttt{lon\_ascending\_node\_planet} & $\Omega$ & \texttt{float} & The longitude of the ascending node of the third body. \\
        \texttt{true\_anomaly\_planet} & $\nu$ & \texttt{float} & The true anomaly of the third body. \\
        \texttt{gr} & - & \texttt{bool} & Whether to include effects from general relativity. \\
        \texttt{eccentricity\_planet} & $e_p$ & \texttt{float} & The eccentricity of the third body's orbit. \\
        \texttt{arg\_pariapsis\_planet} & $\omega$ & \texttt{float} & The argument of pariapsis of the third body's orbit. \\
        \hline
    \end{tabular}
    \caption{ {\sc REBOUND} Simulation parameters}
    \label{tab:params}
\end{table*}

We use {\sc REBOUND}'s Python interface to initialize our simulation. Table \ref{tab:params} describes the simulation's
input parameters. We integrate the system using the IAS15 15th order Gauss-Radau integrator \citep{reboundias15}
until we can determine the system's state.

Not much can be learned from a single simulation as it only allows us to map from one point in $(i,\Omega)$ space to an end state. To infer the behavior of a population
(and from that compute a polar fraction) we employ a Monte Carlo (MC) method, sampling isotropically on the $(i,\Omega)$ sphere. That is, $\Omega \in \mathcal{U}(0,2\pi)$
and $i \in \{\arcsin{(2u-1)} + \frac{\pi}{2} \mid u \in \mathcal{U}(0,1)\}$.

\begin{figure*}
    \begin{centering}
        \includegraphics[width=\textwidth]{figures/mc_example.pdf}
        \caption{Monte Carlo results for a $1 M_\odot$ equal mass binary with $e_b=0.4$ for $j=0,0.5,1$. The position of each
        point shows the initial condition of the simulation, and the color denotes the dynamical state. Note that some are marked
        as ``unknown''. This is because we set a 1000 orbit limit on the integration for the sake of computational time.}
        \script{mc_example.py}
        \label{fig:mc}
    \end{centering}
\end{figure*}

Each MC run is initialized with the conditions of the binary as well as the angular momentum of the disk. We then sample $i$ and $\Omega$ in batches of four simulations,
using a bootstrap metric after each batch to compute the polar fraction. Sampling stops when the bootstrap-computed confidence interval reaches a prescribed value. A 
typical simulation takes on the order of $0.1-1$ s, so we save the results of each simulation in an SQLite database between batches. When an MC sampler is initialized
it queries this database for all relevant passed simulations, ingests them, and only runs new simulations if a more stringent confidence interval is requested.


\begin{figure}
    \begin{centering}
        \includegraphics[width=0.5\textwidth]{figures/compare_massive.pdf}
        \caption{
            Contour lines denoting solution boundaries found via the RKF method compared to MC results of the same conditions. Binary setup is the same
            as in Figure \ref{fig:mc}, but for $j=0.66$, which is its critical value \citep[see][]{martin2019,abod2022}. The grid here includes 250,000 points.
            There is some disagreement between RKF and {\sc REBOUND}, which we attribute to misclassification due to behavior on the orbital timescale (i.e. 
            small variations in $\Omega$ that cause the simulation to temporarily cross the $y$-axis twice, giving the false appearance of libration). \TJ{We can fix this}
            The MC result gives $f_{\text{polar}} = \variable{output/mc_out.txt}$ while the RKF result gives $f_{\text{polar}} = \variable{output/rk_out.txt}$ with
            numerical error on the order of $\variable{output/rk_err.txt}$.
        }
        \script{compare_massive.py}
        \label{fig:rkf}
    \end{centering}
\end{figure}


\section{Results}
\label{sec:results}

To determine the polar fraction of a given population we must consider three distributions:
\begin{enumerate}
    \item The direction of disk angular momentum $\bm{l}$ \label{it:l} \\
    \item The scalar relative disk angular momentum $j$ \label{it:j} \\
    \item The binary eccentricity $e_{\rm b}$ \label{it:eb}
\end{enumerate}

In Section \ref{sec:methods} we made the simplifying assumption that $\bm{l}$ is isotropic. Note that this is in contrast to the exponential distribution in
mutual inclination employed by \citet{ceppi2024}. The decaying exponential prefers disks that are aligned with the binary -- valid in the wide-binary regime, but
hydrodynamic simulations by \citep{elsender2023} found that for binaries with separations on the order of 1 AU that mutual inclinations are seemingly randomly
distributed between $0$ and $\pi$. % See their fig 8

\begin{figure*}
    \begin{centering}
        \includegraphics[width=1\textwidth]{figures/compare_ebin.pdf}
        \caption{
            Polar fraction as a function of $e_{\rm b}$ for various values of $j$. Each fraction is calculated using a $100\times 100$ grid of RKF integrations.
            The dashed lines shows the analytic solution for a massless disk from \citet{zanazzi2018} (in yellow) and from \citet{martin2019} (in gray), integrated numerically.
            There are two competing effects here:
            In the low-$j$ regime the polar fraction is a strong function of $e_{\rm b}$. However, as $j$ increases, $f_{\rm polar}$ is only sensitive to eccentricity
            when $e_{\rm b} \sim 1$, and otherwise prefers a flat distribution.
        }
        \script{compare_ebin.py}
        \label{fig:ebin}
    \end{centering}
\end{figure*}

First, let's not consider the other two distributions, and leave $j$ and $e_{\rm b}$ as free parameters. Figure \ref{fig:ebin} shows that the polar fraction
as a function of $e_{\rm b}$ can be modulated by $j$ to display two behaviors. There exists an analytic solution by \citet{zanazzi2018}, and the tendency is
for $f_{\rm polar}$ to follow this solution either when $j$ is low or $e_{\rm b}$ is very high. Contrarily, if $j$ is sufficiently large, then a flat distribution
(e.i. no dependence on $e_{\rm b}$) is preferred except for when $e_{\rm b}$ is very nearly $1$ (see Section \ref{subsubsec:hi_j}).

\subsection{An upper limit on the polar fraction}
\label{subsec:fp_limit}
While the true astrophysical distributions of $i$, $e_{\rm b}$, and $j$ are unknown, we can still place constraints on the value of $f_{\rm polar}$.
As discussed previously, if the disk has no preference for coplanar alignment then we can replace $di$ in Equation \ref{eq:fp_int} with $\frac{1}{2}\sin{du_i}du_i$, integrating
from 0 to $\pi$.

To decide on a distribution for $e_{\rm b}$ let's first look at the behavior of $\Omega_{\rm min}$ in Equation \ref{eq:omega_min}. Let $\gamma$
be the RHS of that equation. By isolating $\Omega_{\rm min}$ and differentiating we can see that, with respect to $\gamma$,
\begin{equation}
    \frac{d\Omega_{\rm min}}{d \gamma} = \frac{1}{2\sqrt{ \gamma (1 - \gamma)}} > 0
\end{equation}

Differentiating $\gamma$ tells us regardless of $\chi$ that $\frac{d\gamma}{de_{\rm b}} < 0$, so
\begin{equation}
    \frac{d\Omega_{\rm min}}{de_{\rm b}} < 0
\end{equation}
or that the polar fraction always increases with increasing binary eccentricity.
To truly get an upper limit we should choose from a family of distributions one that prefers high eccentricities. However, typical distribution
functions have the form $P(e_{\rm b}) \propto e_{\rm b}^\alpha$ \citep[e.g.][]{hwang2022,ceppi2024}, in which the ``upper limit'' distribution
is one in which $\alpha \rightarrow \infty$ and $P(e_{\rm b})$ approaches the delta function $\delta(e_{\rm b} - 1)$. This would result in a polar frequency
of 1. \citet{hwang2022} suggests that for binaries with separations less than 100 AU it is appropriate to adopt a random distribution (i.e. $\alpha=0$). We then simply
integrate $de_{\rm b}$ from 0 to 1.

\TJ{Now for the question of how to integrate $j$...}

\section{Discussion}
\label{sec:discussion}

\section{Conclusions}
\label{sec:conclusions}





\section{Acknowledgements}
\label{sec:ack}

This manuscript was prepared using the open-science software \href{https://show-your.work/en/latest/intro/}{\showyourwork} \citep{luger2021}, making the article completely
reproducible. The source code to compile this document and create the figures is available on GitHub\footnote{\ghurl}.

Simulations in this paper made use of the REBOUND N-body code \citep{rebound}.
The simulations were integrated using IAS15, a 15th order Gauss-Radau integrator \citep{reboundias15}. 


\bibliography{cbdisk,syw,reb}

\end{document}
